<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0082)http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title> Calendar Heatmaps to Visualize Time Series Data</title>
<meta name="generator" content="WordPress 3.8">  
<link rel="stylesheet" href="./Calendar Heatmaps to Visualize Time Series Data_files/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://flowingdata.com/feed">
<link rel="pingback" href="http://flowingdata.com/xmlrpc.php">
<link rel="shortcut icon" href="http://flowingdata.com/wp-content/themes/flowingdata-4-8/images/favicon.ico">
<script src="./Calendar Heatmaps to Visualize Time Series Data_files/quant.js" async="" type="text/javascript"></script><script async="" type="text/javascript" src="http://www.googletagservices.com/tag/js/gpt.js"></script><script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/jquery-1.4.4.min.js"></script>
<script type="text/javascript">
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    (function() {
    var gads = document.createElement('script');
    gads.async = true;
    gads.type = 'text/javascript';
    var useSSL = 'https:' == document.location.protocol;
    gads.src = (useSSL ? 'https:' : 'http:') + 
    '//www.googletagservices.com/tag/js/gpt.js';
    var node = document.getElementsByTagName('script')[0];
    node.parentNode.insertBefore(gads, node);
    })();
    </script>
<script type="text/javascript">
    googletag.cmd.push(function() {
    googletag.defineSlot('/2462688/Sidebar_rectangle', [300, 250], 'div-gpt-ad-1332011316310-2').addService(googletag.pubads());
    googletag.defineSlot('/2462688/Square1', [125, 125], 'div-gpt-ad-1332011316310-3').addService(googletag.pubads());
    googletag.defineSlot('/2462688/Square2', [125, 125], 'div-gpt-ad-1332011316310-4').addService(googletag.pubads());
    googletag.defineSlot('/2462688/Square3', [125, 125], 'div-gpt-ad-1332011316310-5').addService(googletag.pubads());
    googletag.defineSlot('/2462688/Square4', [125, 125], 'div-gpt-ad-1358209090048-5').addService(googletag.pubads());
googletag.defineSlot('/2462688/Bottom_Post', [300, 250], 'div-gpt-ad-1332011316310-0').addService(googletag.pubads());    googletag.pubads().enableSingleRequest();
    googletag.pubads().collapseEmptyDivs();
    googletag.enableServices();
    });
    </script>
<link rel="alternate" type="application/rss+xml" title="FlowingData » Calendar Heatmaps to Visualize Time Series Data Comments Feed" href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/feed/">
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/jquery.js"></script>
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/jquery-migrate.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://flowingdata.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://flowingdata.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Comparing heritage in the Melting Pot" href="http://flowingdata.com/2012/03/15/comparing-heritage-in-the-melting-pot/">
<link rel="next" title="Poor Visualization Can Do More Harm Than Good" href="http://flowingdata.com/2012/03/15/poor-visualization-can-do-more-harm-than-good/">
<meta name="generator" content="WordPress 3.8">
<link rel="canonical" href="./Calendar Heatmaps to Visualize Time Series Data_files/Calendar Heatmaps to Visualize Time Series Data.html">
<link rel="shortlink" href="http://flowingdata.com/?p=22383">
 <script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/democracy.js"></script><link rel="stylesheet" href="./Calendar Heatmaps to Visualize Time Series Data_files/basic.css" type="text/css"><link rel="stylesheet" href="./Calendar Heatmaps to Visualize Time Series Data_files/style(1).css" type="text/css"><link rel="stylesheet" href="./Calendar Heatmaps to Visualize Time Series Data_files/wp-page-numbers.css" type="text/css" media="screen"><style type="text/css">img#wpstats{display:none}</style><link rel="stylesheet" type="text/css" href="./Calendar Heatmaps to Visualize Time Series Data_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Calendar Heatmaps to Visualize Time Series Data_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<style>#iuksgrdnhlginqbcdwjcvicsxwbchaor{border:solid 2px #fff !important;box-sizing:content-box !important;color:#fff !important;display:block !important;height:auto !important;margin:0 !important;opacity:0.9 !important;padding:7px 10px !important;position:fixed !important;visibility:visible !important;width:auto !important;z-index:2147483647 !important;-webkit-border-radius:5px !important;-webkit-box-shadow:0px 0px 20px #000 !important;-webkit-box-sizing:content-box !important;}.iuksgrdnhlginqbcdwjcvicsxwbchaor-blocked{color:#777 !important;display:inline !important;text-decoration:line-through !important;}#iuksgrdnhlginqbcdwjcvicsxwbchaor br{display:block !important;}#iuksgrdnhlginqbcdwjcvicsxwbchaor span{background:transparent !important;}#iuksgrdnhlginqbcdwjcvicsxwbchaor div{border:0 !important;margin:0 !important;padding:0 !important;width:auto !important;letter-spacing:normal !important;font:13px Arial,Helvetica !important;text-align:left !important;text-shadow:none !important;text-transform:none !important;word-spacing:normal !important;}#iuksgrdnhlginqbcdwjcvicsxwbchaor a{font-weight:normal !important;background:none !important;text-decoration:underline !important;color:#fff !important;}@media print{#iuksgrdnhlginqbcdwjcvicsxwbchaor{display:none !important;}}</style></head><style type="text/css">embed[type*="application/x-shockwave-flash"],embed[src*=".swf"],object[type*="application/x-shockwave-flash"],object[codetype*="application/x-shockwave-flash"],object[src*=".swf"],object[codebase*="swflash.cab"],object[classid*="D27CDB6E-AE6D-11cf-96B8-444553540000"],object[classid*="d27cdb6e-ae6d-11cf-96b8-444553540000"],object[classid*="D27CDB6E-AE6D-11cf-96B8-444553540000"]{	display: none !important;}</style>
<body style="">
<a name="top"></a>
<div id="topnav">
<div id="topnav-content" class="content">
<div id="login" class="float-right">
<span id="username-meta">Logged in as <a href="http://flowingdata.com/profile/">abresler</a> &nbsp;&nbsp;</span>
<a href="http://flowingdata.com/wp-login.php?action=logout&_wpnonce=d018091d15">Log out</a> </div>
</div>
<div class="clear-line"></div>
</div> 
<div id="header">
<div id="header-content" class="content">
<div id="nav">
<a href="http://flowingdata.com/">
<img src="./Calendar Heatmaps to Visualize Time Series Data_files/logo.png" class="float-left" scale="0">
</a>
<div id="pages" class="float-right">
<ul>
<li><a href="http://flowingdata.com/membership/">Membership</a></li>
<li><a href="http://flowingdata.com/learning/">Learning</a></li>
<li><a href="https://jobs.flowingdata.com/">Job Board</a></li>
<li><a href="http://flowingdata.com/category/projects/">Projects</a></li>
<li><a href="http://flowingdata.com/about/">About</a></li>
</ul>
</div> 
<div class="clear-line"></div>
</div> 
</div> 
</div> 
<div class="clear-line"></div>
<div id="main-wrapper">
<div id="content-wrapper" class="content">
<div class="post" id="post-22383">
<div id="content" class="single-long">
<div class="entry">
<div class="category">
<a href="http://flowingdata.com/category/tutorials/" title="View all posts in Tutorials" rel="category tag">Tutorials</a> &nbsp;/&nbsp; <a href="http://flowingdata.com/tag/calendar/" rel="tag">calendar</a>, <a href="http://flowingdata.com/tag/r/" rel="tag">R</a> <span class="members-note"><a href="http://flowingdata.com/members-only">Members Only</a></span> </div>
<h1>Calendar Heatmaps to Visualize Time Series Data</h1>
<div class="clear-line"></div>
<div class="author">
By <strong>Nathan Yau</strong>
</div> 
<div id="lead-in">
<p class="img-right"><img src="./Calendar Heatmaps to Visualize Time Series Data_files/calendar-sample1.png" class="attachment-long-form-thumb wp-post-image" alt="Calendar heatmaps made easy" width="425" height="230" src-orig="http://i2.wp.com/flowingdata.com/wp-content/uploads/2012/03/calendar-sample1.png?fit=425%2C9999" scale="2"></p>
<div class="entry-excerpt">
The familiar but underused layout is a good way to look at patterns over time. This tutorial gives you an easy way to make them and guides you through the code so you can adapt it to your needs. </div>
<div id="tut-meta">
<div class="button-link"><a href="http://flowingdata.com/2012/01/11/vehicles-involved-in-fatal-crashes/">Demo</a></div>
<div class="button-link"><a href="http://flowingdata.com/?s2member_file_download=2012/calendar-heatmap-tutorial.zip">Download Source</a></div>
<div class="clear-line"></div>
</div> 
<div class="clear-line"></div>
</div> 
<div class="entry-content">
<p>I recently had to produce a bunch of calendar heatmaps to study time series data with many categories. Think small multiples with calendars. A quick search brought me to <a href="http://blog.revolutionanalytics.com/2009/11/charting-time-series-as-calendar-heat-maps-in-r.html">code</a> provided by Paul Bleicher, but it wasn't quite what I wanted, so instead of learning how his code worked, I just wrote my own. I ended up using it for <a href="http://flowingdata.com/2012/01/11/vehicles-involved-in-fatal-crashes/">this graphic</a> that shows number of vehicles involved in fatal crashes in 2010.<br>
<span id="more-22383"></span></p>
<h2>Setup</h2>
<p><span class="tip">I like to load packages as I need them, but at school the sysadmin of the department would just install all the packages. Either way is fine.</span>This is all in R, so go ahead and download and install that if you haven't already. It's free and open source. You will also need a package called "foreign" to load the data (which is a DBF file) in this tutorial. In R, go to Packages &amp; Data → Package Installer, and then click on Get List. Select the foreign package and install. That's it. You'll make all the visuals using base functionality in R.</p>
<h2>Loading Data</h2>
<p>The data for this tutorial comes from the National Highway Traffic Safety Administration as a DBF file. They offer annual data (apparently a couple of years behind) via FTP, but location is likely to change, so I included the data in the download in FARS2010/accident.dbf. In previous tutorials you used <code>read.csv()</code> to get the data into R, but that's not going to work here, since it's, um, not a CSV file. R doesn't provide a <code>read.dbf()</code> function in the base, but the foreign package does. So load the package with <code>library()</code> and then use <code>read.dbf()</code> to load accident.dbf.</p>
<div id="highlighter_156148" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_156148_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_156148" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Load data from .dbf file and aggregate by day</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="functions">library</code><code class="plain">(foreign)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">accidents &lt;- </code><code class="functions">read.dbf</code><code class="plain">(</code><code class="string">"FARS2010/accident.dbf"</code><code class="plain">)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>Take a look at the first few rows of the data.</p>
<div id="highlighter_294296" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_294296_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_294296" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">accidents[1:2,]</code></td></tr></tbody></table></div></div></div>
<p><span class="tip">See the Accidents section in 811529.pdf for details on every metric.</span>Every row represents an accident that occurred in 2010, and each accident has 47 variables. That is, there are 47 columns in this dataset, such as state (<code>STATE</code>), vehicles involved (<code>VE_TOTAL</code>), and day, month, and year (<code>DAY</code>, <code>MONTH</code>, and <code>YEAR</code>).</p>
<p>For the purposes of this tutorial, you want to know the number of vehicles involved per day though, so you need to aggregate by day, and you can do that with the aptly named <code>aggregate()</code> function. Read the below line of code as "the sum of <code>VE_TOTAL</code>, by unique <code>YEAR</code>, <code>MONTH</code>, and <code>DAY</code> combination."</p>
<div id="highlighter_440363" class="syntaxhighlighter  "><div class="bar "><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_440363_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_440363" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">accidents.agg &lt;- </code><code class="functions">aggregate</code><code class="plain">(VE_TOTAL ~ YEAR + MONTH + DAY, data=accidents, sum)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>View the first two rows of the newly created <code>accidents.agg</code>. It's a data frame with four columns: year, month, day, and the daily sum, and there's a row for each day.</p>
<div id="highlighter_659618" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_659618_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_659618" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">accidents.agg[1:2,]</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>Combine the first three columns as a string with dates in the format of YYYY-MM-DD in <code>dates</code>, and store the daily totals in <code>vehicles</code>. It'll be more clear why you do this later, but basically, it's easier to handle.</p>
<div id="highlighter_120279" class="syntaxhighlighter  "><div class="bar "><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_120279_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_120279" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Prepare for calendarFlow()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">dates &lt;- </code><code class="functions">paste</code><code class="plain">(accidents.agg$YEAR, accidents.agg$MONTH, accidents.agg$DAY, sep=</code><code class="string">"-"</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">vehicles &lt;- accidents.agg$VE_TOTAL</code></td></tr></tbody></table></div></div></div>
<p></p>
<h2>Drawing Calendar</h2>
<p><span class="tip">If you don't care about the inner workings of the code, open accidents.R in the download for sample usage (or skip to the bottom of this tutorial). It's packaged nicely in a function called <code>calendarFlow()</code>, so you can make a calendar with a single line.</span>The goal is to write a function similar to Paul Bleicher's. The function is called <code>calendarFlow()</code> and when it's done, you should be able to plug in a vector of dates and vector of values to get a calendar heatmap in return.</p>
<p>Declare the function with the inputs you want to provide. For reference, this is the start of calendarCustom.R.</p>
<div id="highlighter_873525" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_873525_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_873525" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">calendarFlow &lt;- </code><code class="keyword">function</code><code class="plain">(dates, values, date.form = </code><code class="string">"%Y-%m-%d"</code><code class="plain">, span=</code><code class="keyword">NA</code><code class="plain">, palette=</code><code class="string">"red"</code><code class="plain">, main=</code><code class="keyword">NA</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>The code that follows goes inside the brackets of <code>calendarFlow()</code>.</p>
<h3>Color</h3>
<p><span class="tip">This might look <a href="http://flowingdata.com/2012/01/19/using-color-scales-and-palettes-in-r/">familiar</a>.</span>The first bit of code provides color options, so that you can pass "red", "blue", or "green" as the value to the the <code>palette</code> argument. Anything else will be a purple color palette. You could modify this code so that you could pass a color ramp palette as an argument, but this way you don't have to remember hexadecimal codes, and it's relatively easy to change the color options.</p>
<div id="highlighter_862614" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_862614_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_862614" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Color palettes</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">ncolors &lt;- 100</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="functions">if </code><code class="plain">(palette == </code><code class="string">"red"</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pal &lt;- </code><code class="functions">colorRampPalette</code><code class="plain">(</code><code class="functions">c</code><code class="plain">(</code><code class="string">"#fadbe0"</code><code class="plain">, </code><code class="string">"#821122"</code><code class="plain">)) # reddish</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">} </code><code class="keyword">else</code> <code class="functions">if </code><code class="plain">(palette == </code><code class="string">"blue"</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pal &lt;- </code><code class="functions">colorRampPalette</code><code class="plain">(</code><code class="functions">c</code><code class="plain">(</code><code class="string">"#c9e4fc"</code><code class="plain">, </code><code class="string">"#07457b"</code><code class="plain">)) # blue</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">} </code><code class="keyword">else</code> <code class="functions">if </code><code class="plain">(palette == </code><code class="string">"green"</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pal &lt;- </code><code class="functions">colorRampPalette</code><code class="plain">(</code><code class="functions">c</code><code class="plain">(</code><code class="string">"#dafedd"</code><code class="plain">, </code><code class="string">"#034e0a"</code><code class="plain">)) # green</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="plain">} </code><code class="keyword">else</code> <code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pal &lt;- </code><code class="functions">colorRampPalette</code><code class="plain">(</code><code class="functions">c</code><code class="plain">(</code><code class="string">"#ffffff"</code><code class="plain">, </code><code class="string">"#263867"</code><code class="plain">)) </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="plain">colorgrad &lt;- </code><code class="functions">pal</code><code class="plain">(ncolors)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>Grid color is hardcoded in as white (#ffffff). You could also make this an argument in the function though.</p>
<div id="highlighter_713582" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_713582_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_713582" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Grid color</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">gridColor &lt;- </code><code class="string">"#ffffff"</code></td></tr></tbody></table></div></div></div>
<p></p>
<h3>Data Ranges</h3>
<p>To figure out the color scale, you have to know span of the <code>values</code>. Find the minimum and maximum, and get the difference.</p>
<div id="highlighter_437986" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_437986_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_437986" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Span of values, if not specified</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">maxval &lt;- </code><code class="functions">max</code><code class="plain">(values)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">minval &lt;- </code><code class="functions">min</code><code class="plain">(values)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="functions">if </code><code class="plain">(</code><code class="functions">is.na</code><code class="plain">(span)) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code class="plain">span &lt;- maxval - minval</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<p><span class="tip">This was important for me, because I wanted to look at a lot of calendars at once, so I wanted to minimize the space each one occupied.</span>Similarly, you want to find the timespan of <code>dates</code> and the number of weeks the data covers. This lets you draw a calendar for just the days you have instead of drawing one for a full year with a lot of blank spaces.</p>
<div id="highlighter_280009" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_280009_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_280009" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Find number of weeks</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">dates.ordered &lt;- dates[</code><code class="functions">order</code><code class="plain">(</code><code class="functions">as.Date</code><code class="plain">(dates, format=date.form))]</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">startDate &lt;- </code><code class="functions">strptime</code><code class="plain">(dates.ordered[1], format=date.form)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">endDate &lt;- </code><code class="functions">strptime</code><code class="plain">(dates.ordered[</code><code class="functions">length</code><code class="plain">(dates.ordered)], format=date.form)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">timespan &lt;- </code><code class="functions">difftime</code><code class="plain">(endDate, startDate, units=</code><code class="string">"weeks"</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">numweeks &lt;- </code><code class="functions">as.numeric</code><code class="plain">(timespan, units=</code><code class="string">"weeks"</code><code class="plain">) + 2</code></td></tr></tbody></table></div></div></div>
<p></p>
<h3>Plot Window</h3>
<p>It's time to get visual. Setup a blank plot window where you will drawing everything. A graphics window will appear, but it'll blank.</p>
<div id="highlighter_539820" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_539820_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_539820" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Setup blank plot</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="functions">plot</code><code class="plain">(0, 0, type=</code><code class="string">"n"</code><code class="plain">, xlim=</code><code class="functions">c</code><code class="plain">(0, numweeks), ylim=</code><code class="functions">c</code><code class="plain">(0, 8), asp=1, xaxt=</code><code class="string">'n'</code><code class="plain">, yaxt=</code><code class="string">'n'</code><code class="plain">, ann=</code><code class="keyword">FALSE</code><code class="plain">, bty=</code><code class="string">"n"</code><code class="plain">)</code></td></tr></tbody></table></div></div></div>
<p></p>
<h3>Choose Colors</h3>
<p>The rest is a matter of geometry. A calendar is a set of squares arranged in a specific way, representing Monday through Sunday. In this example, Sundays are on top, and Saturdays are on the bottom. Each column represents a week. So the week number relative to the earliest date is the x-point, and the day of the week is the y-point. If you have those, you can specify where to draw a square for each day.</p>
<p>To figure out the color, you compare the current value to the full range of the data and then map that to the color palette.</p>
<div id="highlighter_29499" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_29499_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_29499" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Draw days</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="functions">for </code><code class="plain">(i </code><code class="keyword">in</code> <code class="plain">1:</code><code class="functions">length</code><code class="plain">(dates)) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code class="functions">if </code><code class="plain">(values[i] &gt; 0) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="plain">currDate &lt;- </code><code class="functions">strptime</code><code class="plain">(dates[i], date.form)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="plain">dayofweek &lt;- currDate$wday</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="comments"># Figure out what color cell should be</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="plain">diff &lt;- </code><code class="functions">difftime</code><code class="plain">(currDate, startDate, units=</code><code class="string">"weeks"</code><code class="plain">) + startDate$wday/6</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="plain">weeknum &lt;- </code><code class="functions">ceiling</code><code class="plain">( </code><code class="functions">as.numeric</code><code class="plain">(diff, units=</code><code class="string">"weeks"</code><code class="plain">) )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="plain">n &lt;- </code><code class="functions">min</code><code class="plain">(ncolors, ncolors * </code><code class="functions">floor</code><code class="plain">(values[i]-minval) / span + 1)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="plain">cellcolor &lt;- colorgrad[n]</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="comments"># Draw colored shaded rectangle</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code class="functions">rect</code><code class="plain">(weeknum, dayofweek, (weeknum+1), (dayofweek+1), col=cellcolor, border=</code><code class="keyword">NA</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp; </code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>Note the offset of <code>startDate$wday/6</code> in the calculation of <code>diff</code>. This is necessary, because you want to know the difference from the first day of the very first week. Or in other words, the first column in the calendar represents the entire week and not just, say, Friday and Saturday. You want to know the number of weeks away from Sunday, the first day of the week (in this example).</p>
<p>Run <code>calendarFlow()</code> as-is, and you get a calendar without grids or labels. Kind of a cool pixelated look.</p>
<div id="highlighter_117031" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_117031_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_117031" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="functions">calendarFlow</code><code class="plain">(dates, vehicles, palette=</code><code class="string">"bluegray"</code><code class="plain">)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p><span class="tip">Calendar without grids or labels</span><img src="./Calendar Heatmaps to Visualize Time Series Data_files/Screen-Shot-2012-03-09-at-10.00.16-PM.png" alt="" title="Plain calendar" class="alignnone size-medium wp-image-22408" width="625" height="90" src-orig="http://i2.wp.com/flowingdata.com/wp-content/uploads/2012/03/Screen-Shot-2012-03-09-at-10.00.16-PM.png?resize=625%2C90" scale="2"></p>
<h3>Daily Grid</h3>
<p>You draw a grid in a similar way to drawing the squares. Iterate through each week and draw a vertical line. Then iterate through each day of the week and draw a horizontal line.</p>
<div id="highlighter_308358" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_308358_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_308358" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Draw calendar grid</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions">for </code><code class="plain">(i </code><code class="keyword">in</code> <code class="plain">1:numweeks) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">lines</code><code class="plain">(</code><code class="functions">c</code><code class="plain">(i, i), </code><code class="functions">c</code><code class="plain">(0, 7), col=gridColor, lwd=.5)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions">for </code><code class="plain">(j </code><code class="keyword">in</code> <code class="plain">0:7) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">lines</code><code class="plain">(</code><code class="functions">c</code><code class="plain">(1, numweeks), </code><code class="functions">c</code><code class="plain">(j, j), col=gridColor, lwd=0.5)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<p><span class="tip">Calendar with grid, more well-defined days</span><img src="./Calendar Heatmaps to Visualize Time Series Data_files/Screen-Shot-2012-03-09-at-10.02.13-PM.png" alt="" title="Calendar with grid" class="alignnone size-medium wp-image-22410" width="625" height="89" src-orig="http://i1.wp.com/flowingdata.com/wp-content/uploads/2012/03/Screen-Shot-2012-03-09-at-10.02.13-PM.png?resize=625%2C89" scale="2"></p>
<h3>Monthly Separators</h3>
<p>If you only use small versions of calendars to look at a lot of them at once, this detail might not be necessary, but it's useful for stand-alone versions. Like in calendars you use for your day-to-day, month separators provide a sense of space.</p>
<p>First figure out the last day of the current month. Draw a line segment of that week, starting from Sunday (bottom) to the end of the last day. For example, if the last day of the month is Saturday, you draw a straight vertical line from bottom to top. If however, the last day is, say, a Wednesday, a vertical line goes from Sunday to Wednesday.</p>
<p><span class="tip">The <code>lwd</code> argument in <code>lines()</code> specifies line width and the <code>lend</code> argument specifies how to end a line. A value of 2 means a straight end, whereas a value of 1 means a rounded end.</span>When this is the case — when the last day of the week is not a Saturday — you then draw another line segment to the previous week (left) and then another line up top the top.</p>
<div id="highlighter_505049" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_505049_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_505049" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Month lines</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">dateseq &lt;- </code><code class="functions">seq</code><code class="plain">(startDate, endDate, by=</code><code class="string">"1 month"</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">for </code><code class="plain">(i </code><code class="keyword">in</code> <code class="plain">1:(</code><code class="functions">length</code><code class="plain">(dateseq)-1)) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">lastDay &lt;- </code><code class="functions">lastDayOfMonth</code><code class="plain">( </code><code class="functions">format</code><code class="plain">(dateseq[i], date.form) )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">diff &lt;- </code><code class="functions">difftime</code><code class="plain">(lastDay, startDate, units=</code><code class="string">"weeks"</code><code class="plain">) + startDate$wday/6</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">weeknum &lt;- </code><code class="functions">ceiling</code><code class="plain">( </code><code class="functions">as.numeric</code><code class="plain">(diff, units=</code><code class="string">"weeks"</code><code class="plain">) )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">dayofweek &lt;- </code><code class="functions">strptime</code><code class="plain">(lastDay, date.form)$wday</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">lines</code><code class="plain">( </code><code class="functions">c</code><code class="plain">( (weeknum+1), (weeknum+1) ), </code><code class="functions">c</code><code class="plain">(0, (dayofweek+1)), col=gridColor, lwd=3, lend=2 )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">if </code><code class="plain">(dayofweek != 6) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">lines</code><code class="plain">( </code><code class="functions">c</code><code class="plain">( (weeknum+1), weeknum ), </code><code class="functions">c</code><code class="plain">( (dayofweek+1), (dayofweek+1)), col=gridColor, lwd=3, lend=2 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">lines</code><code class="plain">( </code><code class="functions">c</code><code class="plain">(weeknum, weeknum), </code><code class="functions">c</code><code class="plain">((dayofweek+1), 7), col=gridColor, lwd=3, lend=2 )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>Here's what you get.</p>
<p><span class="tip">Calendar with lines indicating separate months</span><img src="./Calendar Heatmaps to Visualize Time Series Data_files/Screen-Shot-2012-03-09-at-10.02.44-PM.png" alt="" title="Calendar with month lines" class="alignnone size-medium wp-image-22411" width="625" height="88" src-orig="http://i0.wp.com/flowingdata.com/wp-content/uploads/2012/03/Screen-Shot-2012-03-09-at-10.02.44-PM.png?resize=625%2C88" scale="2"></p>
<p>Note that the above makes use of a helper function (found at the bottom of calendarCustom.R) called <code>lastDayOfMonth()</code>.</p>
<div id="highlighter_597840" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_597840_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_597840" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Helper function to find the last day of month in datestring</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">lastDayOfMonth &lt;- </code><code class="keyword">function</code><code class="plain">(datestring, date.form = </code><code class="string">"%Y-%m-%d"</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">thedate &lt;- </code><code class="functions">strptime</code><code class="plain">(datestring, date.form)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">theyear &lt;- thedate$year + 1900</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">themonth &lt;- thedate$mon + 1</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">themonth.posix &lt;- </code><code class="functions">as.POSIXct</code><code class="plain">(</code><code class="functions">paste</code><code class="plain">(theyear, themonth, </code><code class="string">'1'</code><code class="plain">, sep=</code><code class="string">'-'</code><code class="plain">), format=date.form)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">month.</code><code class="keyword">next</code> <code class="plain">&lt;- </code><code class="functions">seq</code><code class="plain">(themonth.posix, length=2, by=</code><code class="string">'1 month'</code><code class="plain">)[2]</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">last.day &lt;- </code><code class="functions">seq</code><code class="plain">(month.</code><code class="keyword">next</code><code class="plain">, length=2, by=</code><code class="string">'-1 day'</code><code class="plain">)[2]</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">return</code><code class="plain">(</code><code class="functions">strptime</code><code class="plain">(last.day, date.form))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<h3>Labels</h3>
<p>Finally, add labels with <code>text()</code>.</p>
<div id="highlighter_459354" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_459354_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_459354" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Title</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">if </code><code class="plain">(!</code><code class="functions">is.na</code><code class="plain">(main)) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">text</code><code class="plain">(0, 8, main, pos=4, cex=0.7)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">} </code><code class="keyword">else</code> <code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">text</code><code class="plain">(0, 8, </code><code class="functions">paste</code><code class="plain">(startDate, </code><code class="string">"to"</code><code class="plain">, endDate), pos=4, cex=0.7)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments"># Day labels</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">daylabs &lt;- </code><code class="functions">c</code><code class="plain">(</code><code class="string">'S'</code><code class="plain">, </code><code class="string">'M'</code><code class="plain">, </code><code class="string">'T'</code><code class="plain">, </code><code class="string">'W'</code><code class="plain">, </code><code class="string">'R'</code><code class="plain">, </code><code class="string">'F'</code><code class="plain">, </code><code class="string">'S'</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">for </code><code class="plain">(k </code><code class="keyword">in</code> <code class="plain">1:7) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">text</code><code class="plain">(0, k-1/2, daylabs[k], cex=0.5)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p></p>
<h2>Usage</h2>
<p>The rest is easy. You have a wrapped up function now, and you can plug the data in for quick results. So first load the source.</p>
<div id="highlighter_879959" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_879959_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_879959" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Sample usage for calendarFlow()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="functions">source</code><code class="plain">(</code><code class="string">"calendarCustom.R"</code><code class="plain">)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p>Then make a call to <code>calendarFlow()</code>.</p>
<div id="highlighter_341998" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_341998_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_341998" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Make calendar</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="functions">calendarFlow</code><code class="plain">(dates, vehicles, palette=</code><code class="string">"bluegray"</code><code class="plain">)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p><span class="tip">Finished calendar with day labels and main title</span><img src="./Calendar Heatmaps to Visualize Time Series Data_files/Screen-Shot-2012-03-09-at-9.48.02-PM.png" alt="" title="Calendar heatmap" class="alignnone size-medium wp-image-22405" width="625" height="103" src-orig="http://i1.wp.com/flowingdata.com/wp-content/uploads/2012/03/Screen-Shot-2012-03-09-at-9.48.02-PM.png?resize=625%2C103" scale="2"></p>
<p>Or you can make multiple calendars using the <code>par()</code> and then making a call to <code>calendarFlow()</code> however many times you want.</p>
<div id="highlighter_524366" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_524366_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_524366" menu="false" src="http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments"># Make multiple calendars</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="functions">par</code><code class="plain">(mfrow = </code><code class="functions">c</code><code class="plain">(2,2), oma=</code><code class="functions">c</code><code class="plain">(0, 0, 0, 0), mar=</code><code class="functions">c</code><code class="plain">(0, 0, 0, 0))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="functions">calendarFlow</code><code class="plain">(dates, vehicles, palette=</code><code class="string">"bluegray"</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="functions">calendarFlow</code><code class="plain">(dates, </code><code class="functions">rnorm</code><code class="plain">(</code><code class="functions">length</code><code class="plain">(dates), mean = 10, sd = 1), palette=</code><code class="string">"red"</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="functions">calendarFlow</code><code class="plain">(dates, </code><code class="functions">rnorm</code><code class="plain">(</code><code class="functions">length</code><code class="plain">(dates), mean = 10, sd = 1), palette=</code><code class="string">"blue"</code><code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="functions">calendarFlow</code><code class="plain">(dates, </code><code class="functions">rnorm</code><code class="plain">(</code><code class="functions">length</code><code class="plain">(dates), mean = 10, sd = 1), palette=</code><code class="string">"green"</code><code class="plain">)</code></td></tr></tbody></table></div></div></div>
<p></p>
<p><span class="tip">Multiple calendars in a grid layout</span><img src="./Calendar Heatmaps to Visualize Time Series Data_files/Screen-Shot-2012-03-09-at-9.50.38-PM.png" alt="" title="Calendar grid" class="alignnone size-medium wp-image-22403" width="625" height="168" src-orig="http://i1.wp.com/flowingdata.com/wp-content/uploads/2012/03/Screen-Shot-2012-03-09-at-9.50.38-PM.png?resize=625%2C168" scale="2"></p>
<h2>Wrapping Up</h2>
<p>The main takeaway, other than the code to quickly make calendar heatmaps, is that this was all pretty simple function-wise. You didn't use any packages to draw the calendar, and you just had to figure out where to draw the squares and lines. That opens up lots of doors graphically speaking when you want to make custom graphics in R, or any other software that draws lines and squares.</p>
<div class="clear-line"></div>
</div> 
</div> 
<div class="clear-line"></div>
<div id="end"></div>
 
<span id="comments"></span>
<div style="width:625px">
<div id="comments-block">
<h2>18 Comments</h2>
<ul class="commentlist">
<li class="comment byuser comment-author-mnesbittdc even thread-even depth-1" id="li-comment-115351">
<div id="comment-115351" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/28a092d7b29980ac2ed1916dd98537ea" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/28a092d7b29980ac2ed1916dd98537ea?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Michael Nesbitt</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115351">March 16, 2012 at 6:20 am</a>
</span>
</div>
<div class="comment-text"><p>this is amazing. I work for the Federal Highway Administration and I was trying to figure out how to do just what you did. Keep it up!</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor odd alt depth-2" id="li-comment-115369">
<div id="comment-115369" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115369">March 16, 2012 at 10:12 am</a>
</span>
</div>
<div class="comment-text"><p>@Michael — Glad you found it helpful :)</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
<li class="comment byuser comment-author-menzedkelly even depth-2" id="li-comment-115375">
<div id="comment-115375" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/b9e46fddc86698eb402e714eb85eb1ee" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://1.gravatar.com/avatar/b9e46fddc86698eb402e714eb85eb1ee?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">David Menezes</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115375">March 16, 2012 at 12:03 pm</a>
</span>
</div>
<div class="comment-text"><p>agreed this is awesome – thanks.</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
<li class="comment byuser comment-author-holmesy999 odd alt thread-odd thread-alt depth-1" id="li-comment-115457">
<div id="comment-115457" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/abbe397caaefa3dae077e27bbb4a02cd" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/abbe397caaefa3dae077e27bbb4a02cd?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Wade Holmes</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115457">March 17, 2012 at 7:12 pm</a>
</span>
</div>
<div class="comment-text"><p>your ability to have a tutorial on a project that I am currently or about to work on amazes me – I’m looking for a nice way to show traffic counts from a permanent station on a bridge over the last 4 years – what do you think I will be working on next!</p>
<p>In order to keep the “scaling” over all the years the same (ie the heatmap is consistent over all the data and not just for the year), I assume the answer lies in the Data Ranges part and the span of values maxval and minval? – if I specify the span value then it should all be consistent?</p>
<p>I think I will woose out and manually specify them from the min/max I have worked in something like excel out rather than calc it in R and just do one graph output per year rather than combine one output for all the years</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor even depth-2" id="li-comment-115463">
<div id="comment-115463" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115463">March 17, 2012 at 9:04 pm</a>
</span>
</div>
<div class="comment-text"><p>@Wade — You’re exactly right. If you find the maximum and minimum over all years and the maximum span, you should be good to go.</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-holmesy999 odd alt depth-3" id="li-comment-115726">
<div id="comment-115726" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/abbe397caaefa3dae077e27bbb4a02cd" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/abbe397caaefa3dae077e27bbb4a02cd?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Wade Holmes</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115726">March 20, 2012 at 7:42 pm</a>
</span>
</div>
<div class="comment-text"><p># Draw days<br>
for (i in 1:length(dates)) {<br>
if (values[i] &gt; 0) { ……<br>
Does this means if you are missing a value in your file or it is zero, then it colours it nothing?</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
<li class="comment byuser comment-author-nathany bypostauthor even depth-3" id="li-comment-115792">
<div id="comment-115792" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115792">March 21, 2012 at 11:48 am</a>
</span>
</div>
<div class="comment-text"><p>Yes. If you wanted a different color for days with no values, one option would be to draw a rectangle the size of the entire calendar and the color that you wanted first, and then to draw everything else.</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
</ul> 
</li> 
<li class="comment byuser comment-author-mattstiles odd alt thread-even depth-1" id="li-comment-115637">
<div id="comment-115637" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/40f292d8d750aeb536cc75aae3ca4506" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/40f292d8d750aeb536cc75aae3ca4506?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Matt Stiles</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115637">March 19, 2012 at 7:02 pm</a>
</span>
</div>
<div class="comment-text"><p>Nathan, great stuff. Thank you.</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
<li class="comment byuser comment-author-hackathorn even thread-odd thread-alt depth-1" id="li-comment-115693">
<div id="comment-115693" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/ea2c14c080ca4e17c815e3afbed352a8" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/ea2c14c080ca4e17c815e3afbed352a8?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Richard Hackathorn</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115693">March 20, 2012 at 10:10 am</a>
</span>
</div>
<div class="comment-text"><p>I feel so dumb! Got the foreign library installed, and download the FARS2010 folder. The second statement is read.dbf from the downloaded data folder. Keep getting unable to open DBF file. I am confused about R’s assumptions about default directories and file naming conventions. I moved the FARS2010 folder under the R directory in MyDocuments. Working under Win7-64. When using forward slashes, got a weird error “\U used without hex digits…” Changed to backward slashes, which R Nutshell manual said was a NO-NO. It finally worked! Any tips for reducing this R frustration for a newbie?</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor odd alt depth-2" id="li-comment-115695">
<div id="comment-115695" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115695">March 20, 2012 at 10:24 am</a>
</span>
</div>
<div class="comment-text"><p>@Richard — The easiest would be to change your working directory in R. You can do this from the Misc menu or use <code>setwd()</code>. That way you won’t have to deal with typing in file paths.</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
<li class="comment byuser comment-author-andyellis even thread-even depth-1" id="li-comment-115771">
<div id="comment-115771" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/fd61e68042b5e7d5935fbac8445bb593" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://1.gravatar.com/avatar/fd61e68042b5e7d5935fbac8445bb593?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Andy Ellis</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115771">March 21, 2012 at 7:13 am</a>
</span>
</div>
<div class="comment-text"><p>I have a list of Baltimore police Arrests already counted by date from 1/1/2011 to 12/31/2011. The Date format is set as m/d/y. I can’t seem to get calendar flow to work on this even though i could get it to work with the original data. Here is my csv <a href="http://bmoreconnected.net/datasets/Arrests2011" rel="nofollow">http://bmoreconnected.net/datasets/Arrests2011</a> . Do i have it formatted wrong?</p>
<p>Loving the book and the tutorials but on occasion i get stuck!</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor odd alt depth-2" id="li-comment-115793">
<div id="comment-115793" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-115793">March 21, 2012 at 11:53 am</a>
</span>
</div>
<div class="comment-text"><p>@Andy — There’s a <code>date.form</code> argument in the <code>calendarFlow()</code> function, so you can change that to whatever date format your data is in. The default format is yyyy-mm-dd, which is denoted by “%Y-%m-%d”. In your case, you’d use “%m/%d/%Y”. </p>
<p>For more on date formats, enter “?strptime” in the R console.</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
<li class="comment byuser comment-author-luisnavarro even thread-odd thread-alt depth-1" id="li-comment-116405">
<div id="comment-116405" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/c218224b19f7e45adef7c556433014ac" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/c218224b19f7e45adef7c556433014ac?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">luis navarro</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-116405">March 29, 2012 at 9:03 pm</a>
</span>
</div>
<div class="comment-text"><p>Ok I want to get this but i feel im behind in the curve. What tutorials would you recommend before attempting this one?</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor odd alt depth-2" id="li-comment-116416">
<div id="comment-116416" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-116416">March 30, 2012 at 12:01 am</a>
</span>
</div>
<div class="comment-text"><p>You might want to start with a couple of the R tutorials that are ligher on the code:</p>
<p><a href="http://flowingdata.com/2010/01/21/how-to-make-a-heatmap-a-quick-and-easy-solution/" rel="nofollow">http://flowingdata.com/2010/01.....-solution/</a></p>
<p>or</p>
<p><a href="http://flowingdata.com/2010/02/11/an-easy-way-to-make-a-treemap/" rel="nofollow">http://flowingdata.com/2010/02.....a-treemap/</a></p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
<li class="comment byuser comment-author-monglean even thread-even depth-1" id="li-comment-118552">
<div id="comment-118552" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/ae24be55071bb9ea2953588f970ff1da" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/ae24be55071bb9ea2953588f970ff1da?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">monglean lee</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-118552">April 22, 2012 at 8:29 pm</a>
</span>
</div>
<div class="comment-text"><p>Thanks Nathan. Your tutorials are very useful. I have got a question on the heat map tutorial. Any help is greatly appreciated. The column variables of my data set have the same unit, so i thought if they have the same values they should have the same shade, but they are not. I realized that if the column variables have different ranges, the same value of one variable may not have the same shade as the other variable. How do you solve this problem? I want to apply the shade across all variables. Thanks</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor odd alt depth-2" id="li-comment-118737">
<div id="comment-118737" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://twitter.com/flowingdata" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-118737">April 24, 2012 at 9:58 am</a>
</span>
</div>
<div class="comment-text"><p>@monglean — Does setting <code>symm</code> in <code>heatmap()</code> to “none” or “row” do what you want?</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
<li class="comment byuser comment-author-etlegara even thread-odd thread-alt depth-1" id="li-comment-124435">
<div id="comment-124435" class="">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/be2adde3a9ed1ce81e2deb778b382661" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://1.gravatar.com/avatar/be2adde3a9ed1ce81e2deb778b382661?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn">Erika Fille Legara</cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-124435">June 12, 2012 at 9:57 pm</a>
</span>
</div>
<div class="comment-text"><p>Very elementary question, is there a way we can place a legend here? Thanks!</p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
<ul class="children">
<li class="comment byuser comment-author-nathany bypostauthor odd alt depth-2" id="li-comment-124444">
<div id="comment-124444" class="flowingdata-author">
<div class="avatar">
<img alt="" src="./Calendar Heatmaps to Visualize Time Series Data_files/a61decc5c78c05770cb107e4c5cbbb33" class="avatar avatar-50 photo" height="50" width="50" originals="50" src-orig="http://0.gravatar.com/avatar/a61decc5c78c05770cb107e4c5cbbb33?s=50&amp;d=http%3A%2F%2Fflowingdata.com%2Fwp-content%2Fthemes%2Fflowingdata-4-8%2Fimages%2Fblank-square.png%3Fs%3D50&amp;r=PG" scale="2"> </div> 
<div class="comment-content">
<div class="comment-author vcard">
<cite class="fn"><a href="http://flowingdata.com/about-nathan" rel="external nofollow" class="url">Nathan Yau</a></cite> <span class="comment-meta">— <a href="http://flowingdata.com/2012/03/15/calendar-heatmaps-to-visualize-time-series-data/#comment-124444">June 12, 2012 at 11:08 pm</a>
</span>
</div>
<div class="comment-text"><p>@Erika — R has a <code>legend()</code> function that you can use. See use example about midway down on this page:</p>
<p><a href="http://www.harding.edu/fmccown/r/" rel="nofollow">http://www.harding.edu/fmccown/r/</a></p>
<p>And of course, you can always draw it custom:</p>
<p><a href="http://flowingdata.com/2012/06/05/how-to-draw-in-r-and-make-custom-plots/" rel="nofollow">http://flowingdata.com/2012/06.....tom-plots/</a></p>
</div>
<div class="reply">
</div>
</div> 
<div class="clear-line"></div>
</div>
</li> 
</ul> 
</li> 
</ul>
</div> 
</div>
</div>
</div> 
</div> 
</div> 
<div id="footer">
<div id="footer-container" class="content">
<div class="float-left" style="width:32%;margin-right:5%;">
<div id="about" class="sec">
<h3>About</h3>
<p>FlowingData explores how designers, statisticians, and computer scientists are using data to understand ourselves better — mainly through data visualization.</p>
<p>As for me, I'm Nathan Yau, and I have a PhD in statistics, with a background in eating.</p>
<p><a href="http://flowingdata.com/about/">More...</a></p>
</div>
</div>
<div class="float-left" style="width:36%;margin-right:5%;">
<div id="book-single" class="sec">
<h3>Books</h3>
<ul id="books" style="margin-bottom:0">
<li>
<a href="http://flowingdata.com/data-points/"><img src="./Calendar Heatmaps to Visualize Time Series Data_files/DataPoints60x75.png" title="Data Points" class="img-left" style="margin-bottom:0" scale="0"><strong>Data Points</strong><br>Visualization that Means Something</a><br>
<div class="clear-line"></div>
</li>
<li><a href="http://flowingdata.com/visualize-this/"><img src="./Calendar Heatmaps to Visualize Time Series Data_files/flowingdata60x79.jpg" title="Visualize This" class="img-left" style="margin-bottom:0" scale="0"><strong>Visualize This</strong><br>The FlowingData Guide to Design, Visualization, and Statistics</a><br>
<div class="clear-line"></div>
</li>
</ul>
</div> 
</div>
<div class="float-left" style="width:22%">
<div id="follow" class="sec">
<h3>Follow</h3>
<p>
<a href="http://twitter.com/flowingdata">Twitter</a> &nbsp;•&nbsp;
<a href="http://facebook.com/flowingdata">Facebook</a> &nbsp;•&nbsp;
<a href="http://eepurl.com/icL0o">Email</a> &nbsp;•&nbsp;
<a href="http://flowingdata.com/feed">RSS</a>
</p>
</div>
<div id="misc" class="sec">
<h3>Miscellaneous</h3>
<a href="http://flowingdata.com/contact">Contact</a> &nbsp;•&nbsp;
<a href="http://flowingdata.com/advertise">Sponsorship</a> &nbsp;•&nbsp;
<a href="http://flowingdata.bigcartel.com/">Shop</a><a>
</a></div><a>
</a></div><a>
<div class="clear-line"></div>
</a></div><a> 
</a></div><a> 
</a><div id="bottom"><a>
Unless otherwise noted, graphics and words by me are licensed under </a><a href="http://creativecommons.org/licenses/by-nc/3.0/us/">Creative Commons BY-NC</a>. Contact original authors for everything else.
</div>
 
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Calendar Heatmaps to Visualize Time Series Data_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-865100-4");
pageTracker._initData();
pageTracker._trackPageview();
</script>
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/shCore.js"></script>
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/shBrushR.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeDefault.css?ver=2.1.364";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://flowingdata.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = 'view source';
	SyntaxHighlighter.config.strings.copyToClipboard = 'copy to clipboard';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = 'The code is in your clipboard now';
	SyntaxHighlighter.config.strings.print = 'print';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/photon.js"></script>
<script type="text/javascript" src="./Calendar Heatmaps to Visualize Time Series Data_files/devicepx-jetpack.js"></script>
<script src="./Calendar Heatmaps to Visualize Time Series Data_files/e-201350.js" type="text/javascript"></script>
<script type="text/javascript">
	st_go({v:'ext',j:'1:2.7',blog:'1938889',post:'22383',tz:'-8'});
	var load_cmc = function(){linktracker_init(1938889,22383,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script><img id="wpstats" src="./Calendar Heatmaps to Visualize Time Series Data_files/g.gif" alt="" scale="0">
</body></html>